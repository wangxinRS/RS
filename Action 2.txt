# -*- coding:utf-8 -*-
from textrank4zh import TextRank4Keyword, TextRank4Sentence
import pandas as pd
import operator
import jieba

# 输入数据
file = r'C:\Users\dell\Desktop\hw4\news.txt';
data = pd.read_csv(file, encoding='gbk', header=None);
text = ''.join(data.iloc[:, 0]);
print(text);

# 输出关键词，设置文本小写，窗口为2
tr4w = TextRank4Keyword();
tr4w.analyze(text=text, lower=True, window=3);
print('关键词：');
for item in tr4w.get_keywords(20, word_min_len=2):
    print(item.word, item.weight);

# 输出重要的句子
tr4s = TextRank4Sentence();
tr4s.analyze(text=text, lower=True, source='all_filters');
print('摘要：');
# 重要性较高的三个句子
sentence = {};
for item in tr4s.get_key_sentences(num=3):
    # index是语句在文本中位置，weight表示权重
    sentence.setdefault(item.index, item.sentence);
    print(item.index, item.weight, item.sentence);
# 关于index排序，组织成句子
sorted_sentence = sorted(sentence.items(), key=operator.itemgetter(0));
res = '。';
sentences = [s for index, s in sorted_sentence];
res = res.join(sentences) + '。';
# 生成摘要
print('='*40);
print('摘要：', res);
